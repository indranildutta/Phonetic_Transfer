# raw FFs
with(df_time, plotVowels(f1, f2, vowel, group = context,
plot.tokens = F, plot.means = TRUE , pch.tokens = vowel, pch.means = vowel,
var.col.by = gender, var.sty.by = context,
cex.tokens = 0.8, cex.means = 1, alpha.means = 0.5,alpha.tokens = 0.3,
ellipse.line = T,  ellipse.fill = T,
poly.line = F, poly.order = c("\\ae","\\vt"),
xlim = c(700, 2500), ylim = c(100, 1400),
legend.kwd = "bottomright", legend.args = gender,
fill.opacity = 0.1, pretty = TRUE))
# raw FFs
with(df_time, plotVowels(f1, f2, vowel, group = context,
plot.tokens = F, plot.means = TRUE , pch.tokens = vowel, pch.means = vowel,
var.col.by = gender, var.sty.by = context,
cex.tokens = 0.8, cex.means = 1, alpha.means = 0.5,alpha.tokens = 0.3,
ellipse.line = T,  ellipse.fill = T,
poly.line = F, poly.order = c("\\ae","\\vt"),
xlim = c(2500, 700), ylim = c(100, 1400),
legend.kwd = "bottomright", legend.args = gender,
fill.opacity = 0.1, pretty = TRUE))
# raw FFs
with(df_time, plotVowels(f1, f2, vowel, group = gender,
plot.tokens = F, plot.means = TRUE , pch.tokens = vowel, pch.means = vowel,
var.col.by = gender, var.sty.by = context,
cex.tokens = 0.8, cex.means = 1, alpha.means = 0.5,alpha.tokens = 0.3,
ellipse.line = T,  ellipse.fill = T,
poly.line = F, poly.order = c("\\ae","\\vt"),
xlim = c(2500, 700), ylim = c(100, 1400),
legend.kwd = "bottomright", legend.args = gender,
fill.opacity = 0.1, pretty = TRUE))
# F1
phon_acco.model = lmer(f1 ~
gender + vowel +
(1+context|word) + (1+context+vowel|subject),
data= df_lobanov_time, REML=FALSE)
df <- read.csv("RCode/formant_data_5.csv", check.names = TRUE) %>%
rename_all(tolower) %>%
mutate_if(is.character,as.factor)
normF1 <- with(df,normLobanov(cbind(f1_5,f1_15,f1_25,f1_35,f1_45)),group=subject)
normF2 <- with(df,normLobanov(cbind(f2_5,f2_15,f2_25,f2_35,f2_45)),group=subject)
df_lobanov <- data.frame(subject,gender,task,word,context,vowel,normF1,normF2)
attach(df)
df_lobanov <- data.frame(subject,gender,task,word,context,vowel,normF1,normF2)
detach(df)
rm(normF1,normF2)
# lobanov-normalized FFs
df_lobanov_time <- df_lobanov %>%
rename(f1_1=f1_5, f1_2=f1_15, f1_3=f1_25, f1_4=f1_35, f1_5=f1_45, f2_1=f2_5, f2_2=f2_15, f2_3=f2_25, f2_4=f2_35, f2_5=f2_45) %>%
# dplyr pivot() functions: convert data between long(indexed) and wide(cartesian) formats
pivot_longer(starts_with("f"),
names_to = c(".value", "time"),
names_sep = "_",
names_transform = list(time = as.factor)
)
# raw FFs
df_time <- df %>%
select(!c("filename", "f1_mid", "vowel_duration")) %>%
rename(f1_1=f1_5, f1_2=f1_15, f1_3=f1_25, f1_4=f1_35, f1_5=f1_45, f2_1=f2_5, f2_2=f2_15, f2_3=f2_25, f2_4=f2_35, f2_5=f2_45) %>%
# dplyr pivot() functions: convert data between long(indexed) and wide(cartesian) formats
pivot_longer(starts_with("f"),
names_to = c(".value", "time"),
names_sep = "_",
names_transform = list(time = as.factor)
)
# F1
phon_acco.model = lmer(f1 ~
gender + vowel +
(1+context|word) + (1+context+vowel|subject),
data= df_lobanov_time, REML=FALSE)
summary(phon_acco.model)
# F1
phon_acco.model = lmer(f1 ~
gender + vowel + time +
(1+context|word) + (1+context+vowel|subject),
data= df_lobanov_time, REML=FALSE)
summary(phon_acco.model)
# F1
phon_acco.model = lmer(f1 ~
gender + vowel*time +
(1+context|word) + (1+context+vowel|subject),
data= df_lobanov_time, REML=FALSE)
summary(phon_acco.model)
# F1
phon_acco.model = lmer(f1 ~
gender + vowel*time*context +
(1+context|word) + (1+context+vowel|subject),
data= df_lobanov_time, REML=FALSE)
summary(phon_acco.model)
# F1
phon_acco.model = lmer(f1 ~
gender + vowel*time + vowel*context +
(1+context|word) + (1+context+vowel|subject),
data= df_lobanov_time, REML=FALSE)
summary(phon_acco.model)
# F1
phon_acco.model = lmer(f1 ~
gender + vowel + time + vowel*context +
(1+context|word) + (1+context+vowel|subject),
data= df_lobanov_time, REML=FALSE)
summary(phon_acco.model)
# F1
phon_acco.model = lmer(f1 ~
gender + time + vowel*context +
(1+context|word) + (1+context+vowel|subject),
data= df_lobanov_time, REML=FALSE)
summary(phon_acco.model)
# Lobanov-normalized FFs
xlim = c(-2, 2.5)
ylim = c(-2,2.3)
with(df_lobanov_time, plotVowels(f1, f2, vowel, group = time,
plot.tokens = F, plot.means = TRUE , pch.tokens = vowel, pch.means = vowel,
var.col.by = time, var.sty.by = vowel,
cex.tokens = 0.8, cex.means = 1, alpha.means = 0.5,alpha.tokens = 0.3,
ellipse.line = T,  ellipse.fill = T,
poly.line = F, poly.order = c("\\ae","\\vt"),
xlim = xlim, ylim = ylim,
legend.kwd = "bottomright", legend.args = gender,
fill.opacity = 0.1, pretty = TRUE))
temp <- df_lobanov_time %>%
filter(time == "5")
# F1
phon_acco.model = lmer(f1 ~
gender + vowel*context +
(1+context|word) + (1+context+vowel|subject),
data= temp, REML=FALSE)
# F1
phon_acco.model = lmer(f1 ~
gender + vowel +
(1+context|word) + (1+context+vowel|subject),
data= temp, REML=FALSE)
summary(phon_acco.model)
# F1
phon_acco.model = lmer(f1 ~
gender + vowel*context +
(1+context|word) + (1+context+vowel|subject),
data= temp, REML=FALSE)
summary(rePCA(phon_acco.model))
# F1
phon_acco.model = lmer(f1 ~
gender + vowel*context +
(1|word) + (1+context+vowel|subject),
data= temp, REML=FALSE)
summary(phon_acco.model)
# Lobanov-normalized FFs
xlim = c(2.5, -2)
ylim = c(2.3, -2)
with(df_lobanov_time, plotVowels(f1, f2, vowel, group = time,
plot.tokens = F, plot.means = TRUE , pch.tokens = vowel, pch.means = vowel,
var.col.by = time, var.sty.by = vowel,
cex.tokens = 0.8, cex.means = 1, alpha.means = 0.5,alpha.tokens = 0.3,
ellipse.line = T,  ellipse.fill = T,
poly.line = F, poly.order = c("\\ae","\\vt"),
xlim = xlim, ylim = ylim,
legend.kwd = "bottomright", legend.args = gender,
fill.opacity = 0.1, pretty = TRUE))
# F1
phon_acco.model = lmer(f1 ~
gender + time + vowel*context +
(1+context|word) + (1+context+vowel|subject),
data= df_lobanov_time, REML=FALSE)
summary(phon_acco.model)
# full model
phon_acco.model = lmer(f1 ~
gender + time*vowel + context*vowel +
(1+context|word) + (1+context+vowel|subject),
data= df_lobanov_time, REML=FALSE)
summary(phon_acco.model)
with(df_lobanov_time, plotVowels(f1, f2, vowel, group = c(time,context),
plot.tokens = F, plot.means = TRUE , pch.tokens = vowel, pch.means = vowel,
var.col.by = time, var.sty.by = context,
cex.tokens = 0.8, cex.means = 1, alpha.means = 0.5,alpha.tokens = 0.3,
ellipse.line = T,  ellipse.fill = T,
poly.line = F, poly.order = c("\\ae","\\vt"),
xlim = xlim, ylim = ylim,
legend.kwd = "bottomright", legend.args = gender,
fill.opacity = 0.1, pretty = TRUE))
with(df_lobanov_time, plotVowels(f1, f2, vowel, group = time,
plot.tokens = F, plot.means = TRUE , pch.tokens = vowel, pch.means = vowel,
var.col.by = time, var.sty.by = context,
cex.tokens = 0.8, cex.means = 1, alpha.means = 0.5,alpha.tokens = 0.3,
ellipse.line = T,  ellipse.fill = T,
poly.line = F, poly.order = c("\\ae","\\vt"),
xlim = xlim, ylim = ylim,
legend.kwd = "bottomright", legend.args = gender,
fill.opacity = 0.1, pretty = TRUE))
with(df_lobanov_time, plotVowels(f1, f2, vowel, group = time,
plot.tokens = F, plot.means = TRUE , pch.tokens = vowel, pch.means = vowel,
var.col.by = context, var.sty.by = time,
cex.tokens = 0.8, cex.means = 1, alpha.means = 0.5,alpha.tokens = 0.3,
ellipse.line = T,  ellipse.fill = T,
poly.line = F, poly.order = c("\\ae","\\vt"),
xlim = xlim, ylim = ylim,
legend.kwd = "bottomright", legend.args = gender,
fill.opacity = 0.1, pretty = TRUE))
?group
with(df_lobanov_time, plotVowels(f1, f2, vowel, aes(context, time),
plot.tokens = F, plot.means = TRUE , pch.tokens = vowel, pch.means = vowel,
var.col.by = time, var.sty.by = context,
cex.tokens = 0.8, cex.means = 1, alpha.means = 0.5,alpha.tokens = 0.3,
ellipse.line = T,  ellipse.fill = T,
poly.line = F, poly.order = c("\\ae","\\vt"),
xlim = xlim, ylim = ylim,
legend.kwd = "bottomright", legend.args = gender,
fill.opacity = 0.1, pretty = TRUE))
with(df_lobanov_time, plotVowels(f1, f2, vowel,
plot.tokens = F, plot.means = TRUE , pch.tokens = vowel, pch.means = vowel,
var.col.by = time, var.sty.by = context,
cex.tokens = 0.8, cex.means = 1, alpha.means = 0.5,alpha.tokens = 0.3,
ellipse.line = T,  ellipse.fill = T,
poly.line = F, poly.order = c("\\ae","\\vt"),
xlim = xlim, ylim = ylim,
legend.kwd = "bottomright", legend.args = gender,
fill.opacity = 0.1, pretty = TRUE))
with(df_lobanov_time, plotVowels(f1, f2, vowel, group = (time, context),
with(df_lobanov_time, plotVowels(f1, f2, vowel, group = time,
plot.tokens = F, plot.means = TRUE , pch.tokens = vowel, pch.means = vowel,
var.col.by = time, var.sty.by = context,
cex.tokens = 0.8, cex.means = 1, alpha.means = 0.5,alpha.tokens = 0.3,
ellipse.line = T,  ellipse.fill = T,
poly.line = F, poly.order = c("\\ae","\\vt"),
xlim = xlim, ylim = ylim,
legend.kwd = "bottomright", legend.args = gender,
fill.opacity = 0.1, pretty = TRUE))
with(df_lobanov_time, plotVowels(f1, f2, vowel, group = time,
plot.tokens = F, plot.means = TRUE , pch.tokens = vowel, pch.means = vowel,
var.col.by = time, var.sty.by = context,
cex.tokens = 0.8, cex.means = 1, alpha.means = 0.5,alpha.tokens = 0.3,
ellipse.line = F,  ellipse.fill = T,
poly.line = F, poly.order = c("\\ae","\\vt"),
xlim = xlim, ylim = ylim,
legend.kwd = "bottomright", legend.args = gender,
fill.opacity = 0.1, pretty = TRUE))
# full model
phon_acco.model = lmer(f1 ~
gender + time*vowel +
(1+context|word) + (1+context+vowel|subject),
data= df_lobanov_time, REML=FALSE)
# full model
phon_acco.model = lmer(f1 ~
gender + time*vowel +
(1+context|word) + (1+context+vowel|subject),
data= df_lobanov_time, REML=FALSE)
# full model
phon_acco.model = lmer(f1 ~
gender + time*vowel +
(1+context|word) + (1+context+vowel|subject),
data= df_lobanov_time, REML=FALSE)
summary(phon_acco.model)
# full model
phon_acco.model = lmer(f1 ~
gender + time*vowel + vowel*context +
(1+context|word) + (1+context+vowel|subject),
data= df_lobanov_time, REML=FALSE)
summary(phon_acco.model)
# full model
phon_acco.model = lmer(f1 ~
gender + time + vowel*context +
(1+context|word) + (1+context+vowel|subject),
data= df_lobanov_time, REML=FALSE)
summary(phon_acco.model)
# full model
phon_acco.model = lmer(f1 ~
gender + time*vowel*context +
(1+context|word) + (1+context+vowel|subject),
data= df_lobanov_time, REML=FALSE)
summary(phon_acco.model)
# full model
phon_acco.model = lmer(f1 ~
gender + time*vowel + vowel*context +
(1+context|word) + (1+context+vowel|subject),
data= df_lobanov_time, REML=FALSE)
summary(phon_acco.model)
# null model
null.model = lmer(f1~
gender + time*vowel +
(1+context|word) + (1+context+vowel|subject),
data= df_lobanov_time, REML=FALSE)
# full model
phon_acco.model = lmer(f1 ~
gender + time*vowel + vowel*context +
(1|word) + (1+context+vowel|subject),
data= df_lobanov_time, REML=FALSE)
summary(phon_acco.model)
# null model
null.model = lmer(f1~
gender + time*vowel +
(1|word) + (1+context+vowel|subject),
data= df_lobanov_time, REML=FALSE)
summary(null.model)
anova(phon_acco.model, null.model)
# null model
null.model = lmer(f1~
gender + time*vowel + context +
(1|word) + (1+context+vowel|subject),
data= df_lobanov_time, REML=FALSE)
summary(null.model)
anova(phon_acco.model, null.model)
# full model
phon_acco.model = lmer(f1 ~
gender + time*vowel + vowel*context + task +
(1|word) + (1+context+vowel|subject),
data= df_lobanov_time, REML=FALSE)
summary(phon_acco.model)
with(df_lobanov_time, plotVowels(f1, f2, vowel, group = task,
plot.tokens = F, plot.means = TRUE , pch.tokens = vowel, pch.means = vowel,
var.col.by = task, var.sty.by = NULL,
cex.tokens = 0.8, cex.means = 1, alpha.means = 0.5,alpha.tokens = 0.3,
ellipse.line = F,  ellipse.fill = T,
poly.line = F, poly.order = c("\\ae","\\vt"),
xlim = xlim, ylim = ylim,
legend.kwd = "bottomright", legend.args = gender,
fill.opacity = 0.1, pretty = TRUE))
# raw FFs
with(df_time, plotVowels(f1, f2, vowel, group = task,
plot.tokens = F, plot.means = TRUE , pch.tokens = vowel, pch.means = vowel,
var.col.by = task, var.sty.by = context,
cex.tokens = 0.8, cex.means = 1, alpha.means = 0.5,alpha.tokens = 0.3,
ellipse.line = T,  ellipse.fill = T,
poly.line = F, poly.order = c("\\ae","\\vt"),
xlim = c(2500, 700), ylim = c(1400, 100),
legend.kwd = "bottomright", legend.args = gender,
fill.opacity = 0.1, pretty = TRUE))
with(df_lobanov_time, plotVowels(f1, f2, vowel, group = task,
plot.tokens = F, plot.means = TRUE , pch.tokens = vowel, pch.means = vowel,
var.col.by = task, var.sty.by = NULL,
cex.tokens = 0.8, cex.means = 1, alpha.means = 0.5,alpha.tokens = 0.3,
ellipse.line = F,  ellipse.fill = T,
poly.line = F, poly.order = c("\\ae","\\vt"),
xlim = xlim, ylim = ylim,
legend.kwd = "bottomright", legend.args = gender,
fill.opacity = 0.1, pretty = TRUE))
# null model
null.model = lmer(f1~
gender + time*vowel + vowel*context +
(1|word) + (1+context+vowel|subject),
data= df_lobanov_time, REML=FALSE)
anova(phon_acco.model, null.model)
# full model
phon_acco.model = lmer(f1 ~
gender + time*vowel + vowel*context*task +
(1|word) + (1+context+vowel|subject),
data= df_lobanov_time, REML=FALSE)
summary(phon_acco.model)
# full model
phon_acco.model = lmer(f1 ~
gender + time*vowel + vowel*context*task +
(1|word) + (1+context+vowel|subject),
data= temp, REML=FALSE)
# full model
phon_acco.model = lmer(f1 ~
gender +  vowel*context*task +
(1|word) + (1+context+vowel|subject),
data= temp, REML=FALSE)
summary(phon_acco.model)
temp <- df_lobanov_time %>%
filter(time == "1")
# full model
phon_acco.model = lmer(f1 ~
gender +  vowel*context*task +
(1|word) + (1+context+vowel|subject),
data= temp, REML=FALSE)
summary(phon_acco.model)
temp <- df_lobanov_time %>%
filter(time == "5")
# full model
phon_acco.model = lmer(f1 ~
gender +  vowel*context*task +
(1|word) + (1+context+vowel|subject),
data= temp, REML=FALSE)
summary(phon_acco.model)
# full model
phon_acco.model = lmer(f1 ~
gender + time*vowel + vowel*context*task +
(1|word) + (1+context+vowel|subject),
data= df_lobanov_time, REML=FALSE)
summary(phon_acco.model)
# null model
null.model = lmer(f1~
gender + time*vowel + vowel*context +
(1|word) + (1+context+vowel|subject),
data= df_lobanov_time, REML=FALSE)
anova(phon_acco.model, null.model)
# null model
null.model = lmer(f1~
gender + time*vowel + vowel*context + task +
(1|word) + (1+context+vowel|subject),
data= df_lobanov_time, REML=FALSE)
summary(null.model)
anova(phon_acco.model, null.model)
# null model
null.model = lmer(f1~
gender + time*vowel + vowel*context + task*context +
(1|word) + (1+context+vowel|subject),
data= df_lobanov_time, REML=FALSE)
# null model
null.model = lmer(f1~
gender + time*vowel + vowel*context + task*context +
(1|word) + (1+context+vowel|subject),
data= df_lobanov_time, REML=FALSE)
summary(null.model)
anova(phon_acco.model, null.model)
# null model
null.model = lmer(f1~
gender + time*vowel + vowel*context + task*vowel +
(1|word) + (1+context+vowel|subject),
data= df_lobanov_time, REML=FALSE)
summary(null.model)
anova(phon_acco.model, null.model)
View(temp)
knitr::opts_chunk$set(echo = TRUE, warning = TRUE, message = TRUE)
gender_normalized <- with(df_lobanov_time, normLobanov(cbind(f1,f2), group=gender))
library(tidyverse)
library(phonR)
library(stargazer)
library(lme4)
library(lmerTest)
library(pwr)
library(simr)
# replacing vowel symbols with unicode:
remapping_english <- c(`\\ae` = "æ", `\\vt` = "ʌ")
# read in data
df <- read.csv("RCode/formant_data_5.csv", check.names = TRUE) %>%
rename_all(tolower) %>%
mutate(vowel = remapping_english[as.character(vowel)]) %>%
mutate_if(is.character,as.factor)
attach(df)
normF1 <- with(df,normLobanov(cbind(f1_5,f1_15,f1_25,f1_35,f1_45)),group=subject)
normF2 <- with(df,normLobanov(cbind(f2_5,f2_15,f2_25,f2_35,f2_45)),group=subject)
df_lobanov <- data.frame(subject,gender,task,word,context,vowel,normF1,normF2)
detach(df)
rm(normF1,normF2)
# lobanov-normalized FFs
df_lobanov_time <- df_lobanov %>%
rename(f1_1=f1_5, f1_2=f1_15, f1_3=f1_25, f1_4=f1_35, f1_5=f1_45, f2_1=f2_5, f2_2=f2_15, f2_3=f2_25, f2_4=f2_35, f2_5=f2_45) %>%
# dplyr pivot() functions: convert data between long(indexed) and wide(cartesian) formats
pivot_longer(starts_with("f"),
names_to = c(".value", "time"),
names_sep = "_",
names_transform = list(time = as.factor)
)
# raw FFs
df_time <- df %>%
select(!c("filename", "f1_mid", "vowel_duration")) %>%
rename(f1_1=f1_5, f1_2=f1_15, f1_3=f1_25, f1_4=f1_35, f1_5=f1_45, f2_1=f2_5, f2_2=f2_15, f2_3=f2_25, f2_4=f2_35, f2_5=f2_45) %>%
# dplyr pivot() functions: convert data between long(indexed) and wide(cartesian) formats
pivot_longer(starts_with("f"),
names_to = c(".value", "time"),
names_sep = "_",
names_transform = list(time = as.factor)
)
gender_normalized <- with(df_lobanov_time, normLobanov(cbind(f1,f2), group=gender))
df_lobanov_gender_time <- df_lobanov_time %>%
select(!c(f1,f2)) %>%
mutate(f1 = gender_normalized$f1,
f2 = gender_normalized$f2)
View(df_lobanov_gender_time)
temp <- df_lobanov_gender_time %>%
mutate(time = as.numeric(time)) %>%
mutate(time = scale(time))
View(temp)
?scale
?rescale
install.packages("arm")
library(tidyverse)
library(phonR)
library(stargazer)
library(lme4)
library(lmerTest)
library(pwr)
library(simr)
# replacing vowel symbols with unicode:
remapping_english <- c(`\\ae` = "æ", `\\vt` = "ʌ")
# replacing vowel symbols with unicode:
remapping_english <- c(`\\ae` = "æ", `\\vt` = "ʌ")
# read in data
df <- read.csv("RCode/formant_data_5.csv", check.names = TRUE) %>%
rename_all(tolower) %>%
mutate(vowel = remapping_english[as.character(vowel)]) %>%
mutate_if(is.character,as.factor)
attach(df)
normF1 <- with(df,normLobanov(cbind(f1_5,f1_15,f1_25,f1_35,f1_45)),group=subject)
normF2 <- with(df,normLobanov(cbind(f2_5,f2_15,f2_25,f2_35,f2_45)),group=subject)
df_lobanov <- data.frame(subject,gender,task,word,context,vowel,normF1,normF2)
detach(df)
rm(normF1,normF2)
# lobanov-normalized FFs
df_lobanov_time <- df_lobanov %>%
rename(f1_1=f1_5, f1_2=f1_15, f1_3=f1_25, f1_4=f1_35, f1_5=f1_45, f2_1=f2_5, f2_2=f2_15, f2_3=f2_25, f2_4=f2_35, f2_5=f2_45) %>%
# dplyr pivot() functions: convert data between long(indexed) and wide(cartesian) formats
pivot_longer(starts_with("f"),
names_to = c(".value", "time"),
names_sep = "_",
names_transform = list(time = as.factor)
)
# raw FFs
df_time <- df %>%
select(!c("filename", "f1_mid", "vowel_duration")) %>%
rename(f1_1=f1_5, f1_2=f1_15, f1_3=f1_25, f1_4=f1_35, f1_5=f1_45, f2_1=f2_5, f2_2=f2_15, f2_3=f2_25, f2_4=f2_35, f2_5=f2_45) %>%
# dplyr pivot() functions: convert data between long(indexed) and wide(cartesian) formats
pivot_longer(starts_with("f"),
names_to = c(".value", "time"),
names_sep = "_",
names_transform = list(time = as.factor)
)
gender_normalized <- with(df_lobanov_time, normLobanov(cbind(f1,f2), group=gender))
df_lobanov_gender_time <- df_lobanov_time %>%
select(!c(f1,f2)) %>%
mutate(f1 = gender_normalized$f1,
f2 = gender_normalized$f2)
temp <- df_lobanov_gender_time %>%
mutate(time = as.numeric(time)) %>%
mutate(time = scale(time))
